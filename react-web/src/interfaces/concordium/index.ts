import { Dispatch } from 'react'
import { toast } from 'react-toastify'
import { useState, useEffect } from 'react'
import { BigNumber } from '@ethersproject/bignumber'
import StellarSdk from 'stellar-sdk'
import Web3 from 'web3'
import Web3utils from 'web3-utils'

import BridgeContractBuild from 'interfaces/ethereum/Bridge.json'
import { validatorUrls, WithdrawResult } from 'interfaces/http'
import {detectConcordiumProvider, SchemaType} from "@concordium/browser-wallet-api-helpers";
import {AccountTransactionType} from "@concordium/common-sdk/lib/types";
import {JsonRpcClient} from "@concordium/common-sdk/lib/JsonRpcClient";
import {HttpProvider} from "@concordium/common-sdk/lib/providers/httpProvider";
import {CcdAmount} from "@concordium/common-sdk/lib/types/ccdAmount";
import {
    toBuffer,
    deserializeReceiveReturnValue,
    serializeUpdateContractParameters,
} from '@concordium/web-sdk';
import {method} from "lodash";
import {Buffer} from "buffer";

type ConcordiumDepositContractResult = {
  transactionHash: string
  events: {
    Deposit: {
      logIndex: string
    }
  }
}

const connectConcordiumWallet = async (setEthereumAccount: Dispatch<string>): Promise<void> => {
  const provider = await detectConcordiumProvider()
  const accountAddress = await provider.connect()
  if (accountAddress != null) {
    setEthereumAccount(accountAddress)
    // provider.addCIS2Tokens(accountAddress, ['2373'], BigInt(2928), BigInt(0));
  }
}

const depositConcordiumTransaction = async (
  stellarAccount: string,
  concordiumAccount: string,
  value: string
// ): Promise<ConcordiumDepositContractResult> => {
): Promise<void> => {
    const provider = await detectConcordiumProvider()
    const BRIDGE_CONTRACT_RAW_SCHEMA = '//8DAQAAAAoAAABnYm1fQnJpZGdlAQAUAAQAAAAFAAAAdG9rZW4MCAAAAHRva2VuX2lkHQAKAAAAdmFsaWRhdG9ycxACEyEAAAACEwAAAHZhbGlkYXRvcnNfcmVxdWlyZWQCDAAAAAwAAABhZGRWYWxpZGF0b3IEEyEAAAACFRQAAAAMAAAAVW5hdXRob3JpemVkAgsAAABQYXJzZVBhcmFtcwIHAAAATG9nRnVsbAIMAAAATG9nTWFsZm9ybWVkAg4AAABDb250cmFjdFBhdXNlZAITAAAASW52b2tlQ29udHJhY3RFcnJvcgITAAAASW52b2tlVHJhbnNmZXJFcnJvcgIaAAAARmFpbGVkVXBncmFkZU1pc3NpbmdNb2R1bGUCHAAAAEZhaWxlZFVwZ3JhZGVNaXNzaW5nQ29udHJhY3QCJQAAAEZhaWxlZFVwZ3JhZGVVbnN1cHBvcnRlZE1vZHVsZVZlcnNpb24CIAAAAEludmFsaWRDb3VudE9GVmFsaWRhdG9yc1JlcXVpcmVkAhoAAABEdXBsaWNhdGVXaXRoZHJhd1JlcXVlc3RlZAIUAAAAV2l0aGRyYXdBbW91bnRJc1plcm8CEwAAAFdpdGhkcmF3YWxJc0V4cGlyZWQCFQAAAEludmFsaWRWYWxpZGF0b3JJbmRleAIXAAAARHVwbGljYXRlVmFsaWRhdG9ySW5kZXgCIwAAAEludmFsaWROdW1iZXJPZlNpZ25hdHVyZXNBbmRJbmRleGVzAiMAAABJbmNvcnJlY3ROdW1iZXJPZlNpZ25hdHVyZXNTdXBwbGllZAIQAAAASW52YWxpZFNpZ25hdHVyZQITAAAARGVwb3NpdEFtb3VudElzWmVybwIHAAAAZGVwb3NpdAQUAAIAAAALAAAAZGVzdGluYXRpb24TAAEAAAIGAAAAYW1vdW50BRUUAAAADAAAAFVuYXV0aG9yaXplZAILAAAAUGFyc2VQYXJhbXMCBwAAAExvZ0Z1bGwCDAAAAExvZ01hbGZvcm1lZAIOAAAAQ29udHJhY3RQYXVzZWQCEwAAAEludm9rZUNvbnRyYWN0RXJyb3ICEwAAAEludm9rZVRyYW5zZmVyRXJyb3ICGgAAAEZhaWxlZFVwZ3JhZGVNaXNzaW5nTW9kdWxlAhwAAABGYWlsZWRVcGdyYWRlTWlzc2luZ0NvbnRyYWN0AiUAAABGYWlsZWRVcGdyYWRlVW5zdXBwb3J0ZWRNb2R1bGVWZXJzaW9uAiAAAABJbnZhbGlkQ291bnRPRlZhbGlkYXRvcnNSZXF1aXJlZAIaAAAARHVwbGljYXRlV2l0aGRyYXdSZXF1ZXN0ZWQCFAAAAFdpdGhkcmF3QW1vdW50SXNaZXJvAhMAAABXaXRoZHJhd2FsSXNFeHBpcmVkAhUAAABJbnZhbGlkVmFsaWRhdG9ySW5kZXgCFwAAAER1cGxpY2F0ZVZhbGlkYXRvckluZGV4AiMAAABJbnZhbGlkTnVtYmVyT2ZTaWduYXR1cmVzQW5kSW5kZXhlcwIjAAAASW5jb3JyZWN0TnVtYmVyT2ZTaWduYXR1cmVzU3VwcGxpZWQCEAAAAEludmFsaWRTaWduYXR1cmUCEwAAAERlcG9zaXRBbW91bnRJc1plcm8CDwAAAHJlbW92ZVZhbGlkYXRvcgQTIQAAAAIVFAAAAAwAAABVbmF1dGhvcml6ZWQCCwAAAFBhcnNlUGFyYW1zAgcAAABMb2dGdWxsAgwAAABMb2dNYWxmb3JtZWQCDgAAAENvbnRyYWN0UGF1c2VkAhMAAABJbnZva2VDb250cmFjdEVycm9yAhMAAABJbnZva2VUcmFuc2ZlckVycm9yAhoAAABGYWlsZWRVcGdyYWRlTWlzc2luZ01vZHVsZQIcAAAARmFpbGVkVXBncmFkZU1pc3NpbmdDb250cmFjdAIlAAAARmFpbGVkVXBncmFkZVVuc3VwcG9ydGVkTW9kdWxlVmVyc2lvbgIgAAAASW52YWxpZENvdW50T0ZWYWxpZGF0b3JzUmVxdWlyZWQCGgAAAER1cGxpY2F0ZVdpdGhkcmF3UmVxdWVzdGVkAhQAAABXaXRoZHJhd0Ftb3VudElzWmVybwITAAAAV2l0aGRyYXdhbElzRXhwaXJlZAIVAAAASW52YWxpZFZhbGlkYXRvckluZGV4AhcAAABEdXBsaWNhdGVWYWxpZGF0b3JJbmRleAIjAAAASW52YWxpZE51bWJlck9mU2lnbmF0dXJlc0FuZEluZGV4ZXMCIwAAAEluY29ycmVjdE51bWJlck9mU2lnbmF0dXJlc1N1cHBsaWVkAhAAAABJbnZhbGlkU2lnbmF0dXJlAhMAAABEZXBvc2l0QW1vdW50SXNaZXJvAg8AAABzZXRJbXBsZW1lbnRvcnMEFAACAAAAAgAAAGlkFgAMAAAAaW1wbGVtZW50b3JzEAIMFRQAAAAMAAAAVW5hdXRob3JpemVkAgsAAABQYXJzZVBhcmFtcwIHAAAATG9nRnVsbAIMAAAATG9nTWFsZm9ybWVkAg4AAABDb250cmFjdFBhdXNlZAITAAAASW52b2tlQ29udHJhY3RFcnJvcgITAAAASW52b2tlVHJhbnNmZXJFcnJvcgIaAAAARmFpbGVkVXBncmFkZU1pc3NpbmdNb2R1bGUCHAAAAEZhaWxlZFVwZ3JhZGVNaXNzaW5nQ29udHJhY3QCJQAAAEZhaWxlZFVwZ3JhZGVVbnN1cHBvcnRlZE1vZHVsZVZlcnNpb24CIAAAAEludmFsaWRDb3VudE9GVmFsaWRhdG9yc1JlcXVpcmVkAhoAAABEdXBsaWNhdGVXaXRoZHJhd1JlcXVlc3RlZAIUAAAAV2l0aGRyYXdBbW91bnRJc1plcm8CEwAAAFdpdGhkcmF3YWxJc0V4cGlyZWQCFQAAAEludmFsaWRWYWxpZGF0b3JJbmRleAIXAAAARHVwbGljYXRlVmFsaWRhdG9ySW5kZXgCIwAAAEludmFsaWROdW1iZXJPZlNpZ25hdHVyZXNBbmRJbmRleGVzAiMAAABJbmNvcnJlY3ROdW1iZXJPZlNpZ25hdHVyZXNTdXBwbGllZAIQAAAASW52YWxpZFNpZ25hdHVyZQITAAAARGVwb3NpdEFtb3VudElzWmVybwIJAAAAc2V0UGF1c2VkBBQAAQAAAAYAAABwYXVzZWQBFRQAAAAMAAAAVW5hdXRob3JpemVkAgsAAABQYXJzZVBhcmFtcwIHAAAATG9nRnVsbAIMAAAATG9nTWFsZm9ybWVkAg4AAABDb250cmFjdFBhdXNlZAITAAAASW52b2tlQ29udHJhY3RFcnJvcgITAAAASW52b2tlVHJhbnNmZXJFcnJvcgIaAAAARmFpbGVkVXBncmFkZU1pc3NpbmdNb2R1bGUCHAAAAEZhaWxlZFVwZ3JhZGVNaXNzaW5nQ29udHJhY3QCJQAAAEZhaWxlZFVwZ3JhZGVVbnN1cHBvcnRlZE1vZHVsZVZlcnNpb24CIAAAAEludmFsaWRDb3VudE9GVmFsaWRhdG9yc1JlcXVpcmVkAhoAAABEdXBsaWNhdGVXaXRoZHJhd1JlcXVlc3RlZAIUAAAAV2l0aGRyYXdBbW91bnRJc1plcm8CEwAAAFdpdGhkcmF3YWxJc0V4cGlyZWQCFQAAAEludmFsaWRWYWxpZGF0b3JJbmRleAIXAAAARHVwbGljYXRlVmFsaWRhdG9ySW5kZXgCIwAAAEludmFsaWROdW1iZXJPZlNpZ25hdHVyZXNBbmRJbmRleGVzAiMAAABJbmNvcnJlY3ROdW1iZXJPZlNpZ25hdHVyZXNTdXBwbGllZAIQAAAASW52YWxpZFNpZ25hdHVyZQITAAAARGVwb3NpdEFtb3VudElzWmVybwIVAAAAc2V0VmFsaWRhdG9yc1JlcXVpcmVkBAQVFAAAAAwAAABVbmF1dGhvcml6ZWQCCwAAAFBhcnNlUGFyYW1zAgcAAABMb2dGdWxsAgwAAABMb2dNYWxmb3JtZWQCDgAAAENvbnRyYWN0UGF1c2VkAhMAAABJbnZva2VDb250cmFjdEVycm9yAhMAAABJbnZva2VUcmFuc2ZlckVycm9yAhoAAABGYWlsZWRVcGdyYWRlTWlzc2luZ01vZHVsZQIcAAAARmFpbGVkVXBncmFkZU1pc3NpbmdDb250cmFjdAIlAAAARmFpbGVkVXBncmFkZVVuc3VwcG9ydGVkTW9kdWxlVmVyc2lvbgIgAAAASW52YWxpZENvdW50T0ZWYWxpZGF0b3JzUmVxdWlyZWQCGgAAAER1cGxpY2F0ZVdpdGhkcmF3UmVxdWVzdGVkAhQAAABXaXRoZHJhd0Ftb3VudElzWmVybwITAAAAV2l0aGRyYXdhbElzRXhwaXJlZAIVAAAASW52YWxpZFZhbGlkYXRvckluZGV4AhcAAABEdXBsaWNhdGVWYWxpZGF0b3JJbmRleAIjAAAASW52YWxpZE51bWJlck9mU2lnbmF0dXJlc0FuZEluZGV4ZXMCIwAAAEluY29ycmVjdE51bWJlck9mU2lnbmF0dXJlc1N1cHBsaWVkAhAAAABJbnZhbGlkU2lnbmF0dXJlAhMAAABEZXBvc2l0QW1vdW50SXNaZXJvAggAAABzdXBwb3J0cwYQARYAEAEVAwAAAAkAAABOb1N1cHBvcnQCBwAAAFN1cHBvcnQCCQAAAFN1cHBvcnRCeQEBAAAAEAAMFRQAAAAMAAAAVW5hdXRob3JpemVkAgsAAABQYXJzZVBhcmFtcwIHAAAATG9nRnVsbAIMAAAATG9nTWFsZm9ybWVkAg4AAABDb250cmFjdFBhdXNlZAITAAAASW52b2tlQ29udHJhY3RFcnJvcgITAAAASW52b2tlVHJhbnNmZXJFcnJvcgIaAAAARmFpbGVkVXBncmFkZU1pc3NpbmdNb2R1bGUCHAAAAEZhaWxlZFVwZ3JhZGVNaXNzaW5nQ29udHJhY3QCJQAAAEZhaWxlZFVwZ3JhZGVVbnN1cHBvcnRlZE1vZHVsZVZlcnNpb24CIAAAAEludmFsaWRDb3VudE9GVmFsaWRhdG9yc1JlcXVpcmVkAhoAAABEdXBsaWNhdGVXaXRoZHJhd1JlcXVlc3RlZAIUAAAAV2l0aGRyYXdBbW91bnRJc1plcm8CEwAAAFdpdGhkcmF3YWxJc0V4cGlyZWQCFQAAAEludmFsaWRWYWxpZGF0b3JJbmRleAIXAAAARHVwbGljYXRlVmFsaWRhdG9ySW5kZXgCIwAAAEludmFsaWROdW1iZXJPZlNpZ25hdHVyZXNBbmRJbmRleGVzAiMAAABJbmNvcnJlY3ROdW1iZXJPZlNpZ25hdHVyZXNTdXBwbGllZAIQAAAASW52YWxpZFNpZ25hdHVyZQITAAAARGVwb3NpdEFtb3VudElzWmVybwILAAAAdXBkYXRlQWRtaW4EFQIAAAAHAAAAQWNjb3VudAEBAAAACwgAAABDb250cmFjdAEBAAAADBUUAAAADAAAAFVuYXV0aG9yaXplZAILAAAAUGFyc2VQYXJhbXMCBwAAAExvZ0Z1bGwCDAAAAExvZ01hbGZvcm1lZAIOAAAAQ29udHJhY3RQYXVzZWQCEwAAAEludm9rZUNvbnRyYWN0RXJyb3ICEwAAAEludm9rZVRyYW5zZmVyRXJyb3ICGgAAAEZhaWxlZFVwZ3JhZGVNaXNzaW5nTW9kdWxlAhwAAABGYWlsZWRVcGdyYWRlTWlzc2luZ0NvbnRyYWN0AiUAAABGYWlsZWRVcGdyYWRlVW5zdXBwb3J0ZWRNb2R1bGVWZXJzaW9uAiAAAABJbnZhbGlkQ291bnRPRlZhbGlkYXRvcnNSZXF1aXJlZAIaAAAARHVwbGljYXRlV2l0aGRyYXdSZXF1ZXN0ZWQCFAAAAFdpdGhkcmF3QW1vdW50SXNaZXJvAhMAAABXaXRoZHJhd2FsSXNFeHBpcmVkAhUAAABJbnZhbGlkVmFsaWRhdG9ySW5kZXgCFwAAAER1cGxpY2F0ZVZhbGlkYXRvckluZGV4AiMAAABJbnZhbGlkTnVtYmVyT2ZTaWduYXR1cmVzQW5kSW5kZXhlcwIjAAAASW5jb3JyZWN0TnVtYmVyT2ZTaWduYXR1cmVzU3VwcGxpZWQCEAAAAEludmFsaWRTaWduYXR1cmUCEwAAAERlcG9zaXRBbW91bnRJc1plcm8CBwAAAHVwZ3JhZGUEFAACAAAABgAAAG1vZHVsZR4gAAAABwAAAG1pZ3JhdGUVAgAAAAQAAABOb25lAgQAAABTb21lAQEAAAAPFgEdARUUAAAADAAAAFVuYXV0aG9yaXplZAILAAAAUGFyc2VQYXJhbXMCBwAAAExvZ0Z1bGwCDAAAAExvZ01hbGZvcm1lZAIOAAAAQ29udHJhY3RQYXVzZWQCEwAAAEludm9rZUNvbnRyYWN0RXJyb3ICEwAAAEludm9rZVRyYW5zZmVyRXJyb3ICGgAAAEZhaWxlZFVwZ3JhZGVNaXNzaW5nTW9kdWxlAhwAAABGYWlsZWRVcGdyYWRlTWlzc2luZ0NvbnRyYWN0AiUAAABGYWlsZWRVcGdyYWRlVW5zdXBwb3J0ZWRNb2R1bGVWZXJzaW9uAiAAAABJbnZhbGlkQ291bnRPRlZhbGlkYXRvcnNSZXF1aXJlZAIaAAAARHVwbGljYXRlV2l0aGRyYXdSZXF1ZXN0ZWQCFAAAAFdpdGhkcmF3QW1vdW50SXNaZXJvAhMAAABXaXRoZHJhd2FsSXNFeHBpcmVkAhUAAABJbnZhbGlkVmFsaWRhdG9ySW5kZXgCFwAAAER1cGxpY2F0ZVZhbGlkYXRvckluZGV4AiMAAABJbnZhbGlkTnVtYmVyT2ZTaWduYXR1cmVzQW5kSW5kZXhlcwIjAAAASW5jb3JyZWN0TnVtYmVyT2ZTaWduYXR1cmVzU3VwcGxpZWQCEAAAAEludmFsaWRTaWduYXR1cmUCEwAAAERlcG9zaXRBbW91bnRJc1plcm8CBAAAAHZpZXcFFAAHAAAABQAAAGFkbWluFQIAAAAHAAAAQWNjb3VudAEBAAAACwgAAABDb250cmFjdAEBAAAADAUAAAB0b2tlbgwIAAAAdG9rZW5faWQdAAYAAABwYXVzZWQBCgAAAHZhbGlkYXRvcnMQAhMhAAAAAhMAAAB2YWxpZGF0b3JzX3JlcXVpcmVkAgcAAAB2ZXJzaW9uBBUUAAAADAAAAFVuYXV0aG9yaXplZAILAAAAUGFyc2VQYXJhbXMCBwAAAExvZ0Z1bGwCDAAAAExvZ01hbGZvcm1lZAIOAAAAQ29udHJhY3RQYXVzZWQCEwAAAEludm9rZUNvbnRyYWN0RXJyb3ICEwAAAEludm9rZVRyYW5zZmVyRXJyb3ICGgAAAEZhaWxlZFVwZ3JhZGVNaXNzaW5nTW9kdWxlAhwAAABGYWlsZWRVcGdyYWRlTWlzc2luZ0NvbnRyYWN0AiUAAABGYWlsZWRVcGdyYWRlVW5zdXBwb3J0ZWRNb2R1bGVWZXJzaW9uAiAAAABJbnZhbGlkQ291bnRPRlZhbGlkYXRvcnNSZXF1aXJlZAIaAAAARHVwbGljYXRlV2l0aGRyYXdSZXF1ZXN0ZWQCFAAAAFdpdGhkcmF3QW1vdW50SXNaZXJvAhMAAABXaXRoZHJhd2FsSXNFeHBpcmVkAhUAAABJbnZhbGlkVmFsaWRhdG9ySW5kZXgCFwAAAER1cGxpY2F0ZVZhbGlkYXRvckluZGV4AiMAAABJbnZhbGlkTnVtYmVyT2ZTaWduYXR1cmVzQW5kSW5kZXhlcwIjAAAASW5jb3JyZWN0TnVtYmVyT2ZTaWduYXR1cmVzU3VwcGxpZWQCEAAAAEludmFsaWRTaWduYXR1cmUCEwAAAERlcG9zaXRBbW91bnRJc1plcm8CCAAAAHdpdGhkcmF3BBQABgAAAAIAAABpZBMgAAAAAgoAAABleHBpcmF0aW9uBQIAAAB0bxUCAAAABwAAAEFjY291bnQBAQAAAAsIAAAAQ29udHJhY3QBAQAAAAwGAAAAYW1vdW50BQoAAABzaWduYXR1cmVzEAITQAAAAAIHAAAAaW5kZXhlcxACAhUUAAAADAAAAFVuYXV0aG9yaXplZAILAAAAUGFyc2VQYXJhbXMCBwAAAExvZ0Z1bGwCDAAAAExvZ01hbGZvcm1lZAIOAAAAQ29udHJhY3RQYXVzZWQCEwAAAEludm9rZUNvbnRyYWN0RXJyb3ICEwAAAEludm9rZVRyYW5zZmVyRXJyb3ICGgAAAEZhaWxlZFVwZ3JhZGVNaXNzaW5nTW9kdWxlAhwAAABGYWlsZWRVcGdyYWRlTWlzc2luZ0NvbnRyYWN0AiUAAABGYWlsZWRVcGdyYWRlVW5zdXBwb3J0ZWRNb2R1bGVWZXJzaW9uAiAAAABJbnZhbGlkQ291bnRPRlZhbGlkYXRvcnNSZXF1aXJlZAIaAAAARHVwbGljYXRlV2l0aGRyYXdSZXF1ZXN0ZWQCFAAAAFdpdGhkcmF3QW1vdW50SXNaZXJvAhMAAABXaXRoZHJhd2FsSXNFeHBpcmVkAhUAAABJbnZhbGlkVmFsaWRhdG9ySW5kZXgCFwAAAER1cGxpY2F0ZVZhbGlkYXRvckluZGV4AiMAAABJbnZhbGlkTnVtYmVyT2ZTaWduYXR1cmVzQW5kSW5kZXhlcwIjAAAASW5jb3JyZWN0TnVtYmVyT2ZTaWduYXR1cmVzU3VwcGxpZWQCEAAAAEludmFsaWRTaWduYXR1cmUCEwAAAERlcG9zaXRBbW91bnRJc1plcm8CDQAAAHdpdGhkcmF3X2hhc2gGFAAGAAAAAgAAAGlkEyAAAAACCgAAAGV4cGlyYXRpb24FAgAAAHRvFQIAAAAHAAAAQWNjb3VudAEBAAAACwgAAABDb250cmFjdAEBAAAADAYAAABhbW91bnQFCgAAAHNpZ25hdHVyZXMQAhNAAAAAAgcAAABpbmRleGVzEAICFAABAAAABAAAAGhhc2gTIAAAAAIVFAAAAAwAAABVbmF1dGhvcml6ZWQCCwAAAFBhcnNlUGFyYW1zAgcAAABMb2dGdWxsAgwAAABMb2dNYWxmb3JtZWQCDgAAAENvbnRyYWN0UGF1c2VkAhMAAABJbnZva2VDb250cmFjdEVycm9yAhMAAABJbnZva2VUcmFuc2ZlckVycm9yAhoAAABGYWlsZWRVcGdyYWRlTWlzc2luZ01vZHVsZQIcAAAARmFpbGVkVXBncmFkZU1pc3NpbmdDb250cmFjdAIlAAAARmFpbGVkVXBncmFkZVVuc3VwcG9ydGVkTW9kdWxlVmVyc2lvbgIgAAAASW52YWxpZENvdW50T0ZWYWxpZGF0b3JzUmVxdWlyZWQCGgAAAER1cGxpY2F0ZVdpdGhkcmF3UmVxdWVzdGVkAhQAAABXaXRoZHJhd0Ftb3VudElzWmVybwITAAAAV2l0aGRyYXdhbElzRXhwaXJlZAIVAAAASW52YWxpZFZhbGlkYXRvckluZGV4AhcAAABEdXBsaWNhdGVWYWxpZGF0b3JJbmRleAIjAAAASW52YWxpZE51bWJlck9mU2lnbmF0dXJlc0FuZEluZGV4ZXMCIwAAAEluY29ycmVjdE51bWJlck9mU2lnbmF0dXJlc1N1cHBsaWVkAhAAAABJbnZhbGlkU2lnbmF0dXJlAhMAAABEZXBvc2l0QW1vdW50SXNaZXJvAgEfBgAAAAAIAAAATmV3QWRtaW4AAQAAAAkAAABuZXdfYWRtaW4VAgAAAAcAAABBY2NvdW50AQEAAAALCAAAAENvbnRyYWN0AQEAAAAMAQcAAABEZXBvc2l0AAMAAAAGAAAAc2VuZGVyFQIAAAAHAAAAQWNjb3VudAEBAAAACwgAAABDb250cmFjdAEBAAAADAsAAABkZXN0aW5hdGlvbh4gAAAABgAAAGFtb3VudAUCCAAAAFdpdGhkcmF3AAMAAAACAAAAaWQeIAAAAAkAAAByZWNpcGllbnQVAgAAAAcAAABBY2NvdW50AQEAAAALCAAAAENvbnRyYWN0AQEAAAAMBgAAAGFtb3VudAUEDAAAAEFkZFZhbGlkYXRvcgACAAAACQAAAHZhbGlkYXRvch4gAAAABwAAAHZlcnNpb24EBQ8AAABSZW1vdmVWYWxpZGF0b3IAAgAAAAkAAAB2YWxpZGF0b3IeIAAAAAcAAAB2ZXJzaW9uBAYVAAAAU2V0UmVxdWlyZWRWYWxpZGF0b3JzAAEAAAATAAAAdmFsaWRhdG9yc19yZXF1aXJlZAI'
    const methodName = 'deposit'
    const ccdValue = Number(value) * 10**7
    const params = {
        amount: ccdValue,
        destination: stellarAccount
    }
    if (provider) {
        const ok = invokeMethod(methodName, params)
        if (!ok) {
            return;
        }
        const CONTRACT_NAME = "gbm_Bridge"
        const TOKEN_CONTRACT_INDEX = 2945n
        const CONTRACT_SUB_INDEX = 0n
        const method = 'deposit'
        const parameters = {
            amount: ccdValue,
            destination: stellarAccount
        }
        const BRIDGE_CONTRACT_RAW_SCHEMA = '//8DAQAAAAoAAABnYm1fQnJpZGdlAQAUAAQAAAAFAAAAdG9rZW4MCAAAAHRva2VuX2lkHQAKAAAAdmFsaWRhdG9ycxACEyEAAAACEwAAAHZhbGlkYXRvcnNfcmVxdWlyZWQCDAAAAAwAAABhZGRWYWxpZGF0b3IEEyEAAAACFRQAAAAMAAAAVW5hdXRob3JpemVkAgsAAABQYXJzZVBhcmFtcwIHAAAATG9nRnVsbAIMAAAATG9nTWFsZm9ybWVkAg4AAABDb250cmFjdFBhdXNlZAITAAAASW52b2tlQ29udHJhY3RFcnJvcgITAAAASW52b2tlVHJhbnNmZXJFcnJvcgIaAAAARmFpbGVkVXBncmFkZU1pc3NpbmdNb2R1bGUCHAAAAEZhaWxlZFVwZ3JhZGVNaXNzaW5nQ29udHJhY3QCJQAAAEZhaWxlZFVwZ3JhZGVVbnN1cHBvcnRlZE1vZHVsZVZlcnNpb24CIAAAAEludmFsaWRDb3VudE9GVmFsaWRhdG9yc1JlcXVpcmVkAhoAAABEdXBsaWNhdGVXaXRoZHJhd1JlcXVlc3RlZAIUAAAAV2l0aGRyYXdBbW91bnRJc1plcm8CEwAAAFdpdGhkcmF3YWxJc0V4cGlyZWQCFQAAAEludmFsaWRWYWxpZGF0b3JJbmRleAIXAAAARHVwbGljYXRlVmFsaWRhdG9ySW5kZXgCIwAAAEludmFsaWROdW1iZXJPZlNpZ25hdHVyZXNBbmRJbmRleGVzAiMAAABJbmNvcnJlY3ROdW1iZXJPZlNpZ25hdHVyZXNTdXBwbGllZAIQAAAASW52YWxpZFNpZ25hdHVyZQITAAAARGVwb3NpdEFtb3VudElzWmVybwIHAAAAZGVwb3NpdAQUAAIAAAALAAAAZGVzdGluYXRpb24TAAEAAAIGAAAAYW1vdW50BRUUAAAADAAAAFVuYXV0aG9yaXplZAILAAAAUGFyc2VQYXJhbXMCBwAAAExvZ0Z1bGwCDAAAAExvZ01hbGZvcm1lZAIOAAAAQ29udHJhY3RQYXVzZWQCEwAAAEludm9rZUNvbnRyYWN0RXJyb3ICEwAAAEludm9rZVRyYW5zZmVyRXJyb3ICGgAAAEZhaWxlZFVwZ3JhZGVNaXNzaW5nTW9kdWxlAhwAAABGYWlsZWRVcGdyYWRlTWlzc2luZ0NvbnRyYWN0AiUAAABGYWlsZWRVcGdyYWRlVW5zdXBwb3J0ZWRNb2R1bGVWZXJzaW9uAiAAAABJbnZhbGlkQ291bnRPRlZhbGlkYXRvcnNSZXF1aXJlZAIaAAAARHVwbGljYXRlV2l0aGRyYXdSZXF1ZXN0ZWQCFAAAAFdpdGhkcmF3QW1vdW50SXNaZXJvAhMAAABXaXRoZHJhd2FsSXNFeHBpcmVkAhUAAABJbnZhbGlkVmFsaWRhdG9ySW5kZXgCFwAAAER1cGxpY2F0ZVZhbGlkYXRvckluZGV4AiMAAABJbnZhbGlkTnVtYmVyT2ZTaWduYXR1cmVzQW5kSW5kZXhlcwIjAAAASW5jb3JyZWN0TnVtYmVyT2ZTaWduYXR1cmVzU3VwcGxpZWQCEAAAAEludmFsaWRTaWduYXR1cmUCEwAAAERlcG9zaXRBbW91bnRJc1plcm8CDwAAAHJlbW92ZVZhbGlkYXRvcgQTIQAAAAIVFAAAAAwAAABVbmF1dGhvcml6ZWQCCwAAAFBhcnNlUGFyYW1zAgcAAABMb2dGdWxsAgwAAABMb2dNYWxmb3JtZWQCDgAAAENvbnRyYWN0UGF1c2VkAhMAAABJbnZva2VDb250cmFjdEVycm9yAhMAAABJbnZva2VUcmFuc2ZlckVycm9yAhoAAABGYWlsZWRVcGdyYWRlTWlzc2luZ01vZHVsZQIcAAAARmFpbGVkVXBncmFkZU1pc3NpbmdDb250cmFjdAIlAAAARmFpbGVkVXBncmFkZVVuc3VwcG9ydGVkTW9kdWxlVmVyc2lvbgIgAAAASW52YWxpZENvdW50T0ZWYWxpZGF0b3JzUmVxdWlyZWQCGgAAAER1cGxpY2F0ZVdpdGhkcmF3UmVxdWVzdGVkAhQAAABXaXRoZHJhd0Ftb3VudElzWmVybwITAAAAV2l0aGRyYXdhbElzRXhwaXJlZAIVAAAASW52YWxpZFZhbGlkYXRvckluZGV4AhcAAABEdXBsaWNhdGVWYWxpZGF0b3JJbmRleAIjAAAASW52YWxpZE51bWJlck9mU2lnbmF0dXJlc0FuZEluZGV4ZXMCIwAAAEluY29ycmVjdE51bWJlck9mU2lnbmF0dXJlc1N1cHBsaWVkAhAAAABJbnZhbGlkU2lnbmF0dXJlAhMAAABEZXBvc2l0QW1vdW50SXNaZXJvAg8AAABzZXRJbXBsZW1lbnRvcnMEFAACAAAAAgAAAGlkFgAMAAAAaW1wbGVtZW50b3JzEAIMFRQAAAAMAAAAVW5hdXRob3JpemVkAgsAAABQYXJzZVBhcmFtcwIHAAAATG9nRnVsbAIMAAAATG9nTWFsZm9ybWVkAg4AAABDb250cmFjdFBhdXNlZAITAAAASW52b2tlQ29udHJhY3RFcnJvcgITAAAASW52b2tlVHJhbnNmZXJFcnJvcgIaAAAARmFpbGVkVXBncmFkZU1pc3NpbmdNb2R1bGUCHAAAAEZhaWxlZFVwZ3JhZGVNaXNzaW5nQ29udHJhY3QCJQAAAEZhaWxlZFVwZ3JhZGVVbnN1cHBvcnRlZE1vZHVsZVZlcnNpb24CIAAAAEludmFsaWRDb3VudE9GVmFsaWRhdG9yc1JlcXVpcmVkAhoAAABEdXBsaWNhdGVXaXRoZHJhd1JlcXVlc3RlZAIUAAAAV2l0aGRyYXdBbW91bnRJc1plcm8CEwAAAFdpdGhkcmF3YWxJc0V4cGlyZWQCFQAAAEludmFsaWRWYWxpZGF0b3JJbmRleAIXAAAARHVwbGljYXRlVmFsaWRhdG9ySW5kZXgCIwAAAEludmFsaWROdW1iZXJPZlNpZ25hdHVyZXNBbmRJbmRleGVzAiMAAABJbmNvcnJlY3ROdW1iZXJPZlNpZ25hdHVyZXNTdXBwbGllZAIQAAAASW52YWxpZFNpZ25hdHVyZQITAAAARGVwb3NpdEFtb3VudElzWmVybwIJAAAAc2V0UGF1c2VkBBQAAQAAAAYAAABwYXVzZWQBFRQAAAAMAAAAVW5hdXRob3JpemVkAgsAAABQYXJzZVBhcmFtcwIHAAAATG9nRnVsbAIMAAAATG9nTWFsZm9ybWVkAg4AAABDb250cmFjdFBhdXNlZAITAAAASW52b2tlQ29udHJhY3RFcnJvcgITAAAASW52b2tlVHJhbnNmZXJFcnJvcgIaAAAARmFpbGVkVXBncmFkZU1pc3NpbmdNb2R1bGUCHAAAAEZhaWxlZFVwZ3JhZGVNaXNzaW5nQ29udHJhY3QCJQAAAEZhaWxlZFVwZ3JhZGVVbnN1cHBvcnRlZE1vZHVsZVZlcnNpb24CIAAAAEludmFsaWRDb3VudE9GVmFsaWRhdG9yc1JlcXVpcmVkAhoAAABEdXBsaWNhdGVXaXRoZHJhd1JlcXVlc3RlZAIUAAAAV2l0aGRyYXdBbW91bnRJc1plcm8CEwAAAFdpdGhkcmF3YWxJc0V4cGlyZWQCFQAAAEludmFsaWRWYWxpZGF0b3JJbmRleAIXAAAARHVwbGljYXRlVmFsaWRhdG9ySW5kZXgCIwAAAEludmFsaWROdW1iZXJPZlNpZ25hdHVyZXNBbmRJbmRleGVzAiMAAABJbmNvcnJlY3ROdW1iZXJPZlNpZ25hdHVyZXNTdXBwbGllZAIQAAAASW52YWxpZFNpZ25hdHVyZQITAAAARGVwb3NpdEFtb3VudElzWmVybwIVAAAAc2V0VmFsaWRhdG9yc1JlcXVpcmVkBAQVFAAAAAwAAABVbmF1dGhvcml6ZWQCCwAAAFBhcnNlUGFyYW1zAgcAAABMb2dGdWxsAgwAAABMb2dNYWxmb3JtZWQCDgAAAENvbnRyYWN0UGF1c2VkAhMAAABJbnZva2VDb250cmFjdEVycm9yAhMAAABJbnZva2VUcmFuc2ZlckVycm9yAhoAAABGYWlsZWRVcGdyYWRlTWlzc2luZ01vZHVsZQIcAAAARmFpbGVkVXBncmFkZU1pc3NpbmdDb250cmFjdAIlAAAARmFpbGVkVXBncmFkZVVuc3VwcG9ydGVkTW9kdWxlVmVyc2lvbgIgAAAASW52YWxpZENvdW50T0ZWYWxpZGF0b3JzUmVxdWlyZWQCGgAAAER1cGxpY2F0ZVdpdGhkcmF3UmVxdWVzdGVkAhQAAABXaXRoZHJhd0Ftb3VudElzWmVybwITAAAAV2l0aGRyYXdhbElzRXhwaXJlZAIVAAAASW52YWxpZFZhbGlkYXRvckluZGV4AhcAAABEdXBsaWNhdGVWYWxpZGF0b3JJbmRleAIjAAAASW52YWxpZE51bWJlck9mU2lnbmF0dXJlc0FuZEluZGV4ZXMCIwAAAEluY29ycmVjdE51bWJlck9mU2lnbmF0dXJlc1N1cHBsaWVkAhAAAABJbnZhbGlkU2lnbmF0dXJlAhMAAABEZXBvc2l0QW1vdW50SXNaZXJvAggAAABzdXBwb3J0cwYQARYAEAEVAwAAAAkAAABOb1N1cHBvcnQCBwAAAFN1cHBvcnQCCQAAAFN1cHBvcnRCeQEBAAAAEAAMFRQAAAAMAAAAVW5hdXRob3JpemVkAgsAAABQYXJzZVBhcmFtcwIHAAAATG9nRnVsbAIMAAAATG9nTWFsZm9ybWVkAg4AAABDb250cmFjdFBhdXNlZAITAAAASW52b2tlQ29udHJhY3RFcnJvcgITAAAASW52b2tlVHJhbnNmZXJFcnJvcgIaAAAARmFpbGVkVXBncmFkZU1pc3NpbmdNb2R1bGUCHAAAAEZhaWxlZFVwZ3JhZGVNaXNzaW5nQ29udHJhY3QCJQAAAEZhaWxlZFVwZ3JhZGVVbnN1cHBvcnRlZE1vZHVsZVZlcnNpb24CIAAAAEludmFsaWRDb3VudE9GVmFsaWRhdG9yc1JlcXVpcmVkAhoAAABEdXBsaWNhdGVXaXRoZHJhd1JlcXVlc3RlZAIUAAAAV2l0aGRyYXdBbW91bnRJc1plcm8CEwAAAFdpdGhkcmF3YWxJc0V4cGlyZWQCFQAAAEludmFsaWRWYWxpZGF0b3JJbmRleAIXAAAARHVwbGljYXRlVmFsaWRhdG9ySW5kZXgCIwAAAEludmFsaWROdW1iZXJPZlNpZ25hdHVyZXNBbmRJbmRleGVzAiMAAABJbmNvcnJlY3ROdW1iZXJPZlNpZ25hdHVyZXNTdXBwbGllZAIQAAAASW52YWxpZFNpZ25hdHVyZQITAAAARGVwb3NpdEFtb3VudElzWmVybwILAAAAdXBkYXRlQWRtaW4EFQIAAAAHAAAAQWNjb3VudAEBAAAACwgAAABDb250cmFjdAEBAAAADBUUAAAADAAAAFVuYXV0aG9yaXplZAILAAAAUGFyc2VQYXJhbXMCBwAAAExvZ0Z1bGwCDAAAAExvZ01hbGZvcm1lZAIOAAAAQ29udHJhY3RQYXVzZWQCEwAAAEludm9rZUNvbnRyYWN0RXJyb3ICEwAAAEludm9rZVRyYW5zZmVyRXJyb3ICGgAAAEZhaWxlZFVwZ3JhZGVNaXNzaW5nTW9kdWxlAhwAAABGYWlsZWRVcGdyYWRlTWlzc2luZ0NvbnRyYWN0AiUAAABGYWlsZWRVcGdyYWRlVW5zdXBwb3J0ZWRNb2R1bGVWZXJzaW9uAiAAAABJbnZhbGlkQ291bnRPRlZhbGlkYXRvcnNSZXF1aXJlZAIaAAAARHVwbGljYXRlV2l0aGRyYXdSZXF1ZXN0ZWQCFAAAAFdpdGhkcmF3QW1vdW50SXNaZXJvAhMAAABXaXRoZHJhd2FsSXNFeHBpcmVkAhUAAABJbnZhbGlkVmFsaWRhdG9ySW5kZXgCFwAAAER1cGxpY2F0ZVZhbGlkYXRvckluZGV4AiMAAABJbnZhbGlkTnVtYmVyT2ZTaWduYXR1cmVzQW5kSW5kZXhlcwIjAAAASW5jb3JyZWN0TnVtYmVyT2ZTaWduYXR1cmVzU3VwcGxpZWQCEAAAAEludmFsaWRTaWduYXR1cmUCEwAAAERlcG9zaXRBbW91bnRJc1plcm8CBwAAAHVwZ3JhZGUEFAACAAAABgAAAG1vZHVsZR4gAAAABwAAAG1pZ3JhdGUVAgAAAAQAAABOb25lAgQAAABTb21lAQEAAAAPFgEdARUUAAAADAAAAFVuYXV0aG9yaXplZAILAAAAUGFyc2VQYXJhbXMCBwAAAExvZ0Z1bGwCDAAAAExvZ01hbGZvcm1lZAIOAAAAQ29udHJhY3RQYXVzZWQCEwAAAEludm9rZUNvbnRyYWN0RXJyb3ICEwAAAEludm9rZVRyYW5zZmVyRXJyb3ICGgAAAEZhaWxlZFVwZ3JhZGVNaXNzaW5nTW9kdWxlAhwAAABGYWlsZWRVcGdyYWRlTWlzc2luZ0NvbnRyYWN0AiUAAABGYWlsZWRVcGdyYWRlVW5zdXBwb3J0ZWRNb2R1bGVWZXJzaW9uAiAAAABJbnZhbGlkQ291bnRPRlZhbGlkYXRvcnNSZXF1aXJlZAIaAAAARHVwbGljYXRlV2l0aGRyYXdSZXF1ZXN0ZWQCFAAAAFdpdGhkcmF3QW1vdW50SXNaZXJvAhMAAABXaXRoZHJhd2FsSXNFeHBpcmVkAhUAAABJbnZhbGlkVmFsaWRhdG9ySW5kZXgCFwAAAER1cGxpY2F0ZVZhbGlkYXRvckluZGV4AiMAAABJbnZhbGlkTnVtYmVyT2ZTaWduYXR1cmVzQW5kSW5kZXhlcwIjAAAASW5jb3JyZWN0TnVtYmVyT2ZTaWduYXR1cmVzU3VwcGxpZWQCEAAAAEludmFsaWRTaWduYXR1cmUCEwAAAERlcG9zaXRBbW91bnRJc1plcm8CBAAAAHZpZXcFFAAHAAAABQAAAGFkbWluFQIAAAAHAAAAQWNjb3VudAEBAAAACwgAAABDb250cmFjdAEBAAAADAUAAAB0b2tlbgwIAAAAdG9rZW5faWQdAAYAAABwYXVzZWQBCgAAAHZhbGlkYXRvcnMQAhMhAAAAAhMAAAB2YWxpZGF0b3JzX3JlcXVpcmVkAgcAAAB2ZXJzaW9uBBUUAAAADAAAAFVuYXV0aG9yaXplZAILAAAAUGFyc2VQYXJhbXMCBwAAAExvZ0Z1bGwCDAAAAExvZ01hbGZvcm1lZAIOAAAAQ29udHJhY3RQYXVzZWQCEwAAAEludm9rZUNvbnRyYWN0RXJyb3ICEwAAAEludm9rZVRyYW5zZmVyRXJyb3ICGgAAAEZhaWxlZFVwZ3JhZGVNaXNzaW5nTW9kdWxlAhwAAABGYWlsZWRVcGdyYWRlTWlzc2luZ0NvbnRyYWN0AiUAAABGYWlsZWRVcGdyYWRlVW5zdXBwb3J0ZWRNb2R1bGVWZXJzaW9uAiAAAABJbnZhbGlkQ291bnRPRlZhbGlkYXRvcnNSZXF1aXJlZAIaAAAARHVwbGljYXRlV2l0aGRyYXdSZXF1ZXN0ZWQCFAAAAFdpdGhkcmF3QW1vdW50SXNaZXJvAhMAAABXaXRoZHJhd2FsSXNFeHBpcmVkAhUAAABJbnZhbGlkVmFsaWRhdG9ySW5kZXgCFwAAAER1cGxpY2F0ZVZhbGlkYXRvckluZGV4AiMAAABJbnZhbGlkTnVtYmVyT2ZTaWduYXR1cmVzQW5kSW5kZXhlcwIjAAAASW5jb3JyZWN0TnVtYmVyT2ZTaWduYXR1cmVzU3VwcGxpZWQCEAAAAEludmFsaWRTaWduYXR1cmUCEwAAAERlcG9zaXRBbW91bnRJc1plcm8CCAAAAHdpdGhkcmF3BBQABgAAAAIAAABpZBMgAAAAAgoAAABleHBpcmF0aW9uBQIAAAB0bxUCAAAABwAAAEFjY291bnQBAQAAAAsIAAAAQ29udHJhY3QBAQAAAAwGAAAAYW1vdW50BQoAAABzaWduYXR1cmVzEAITQAAAAAIHAAAAaW5kZXhlcxACAhUUAAAADAAAAFVuYXV0aG9yaXplZAILAAAAUGFyc2VQYXJhbXMCBwAAAExvZ0Z1bGwCDAAAAExvZ01hbGZvcm1lZAIOAAAAQ29udHJhY3RQYXVzZWQCEwAAAEludm9rZUNvbnRyYWN0RXJyb3ICEwAAAEludm9rZVRyYW5zZmVyRXJyb3ICGgAAAEZhaWxlZFVwZ3JhZGVNaXNzaW5nTW9kdWxlAhwAAABGYWlsZWRVcGdyYWRlTWlzc2luZ0NvbnRyYWN0AiUAAABGYWlsZWRVcGdyYWRlVW5zdXBwb3J0ZWRNb2R1bGVWZXJzaW9uAiAAAABJbnZhbGlkQ291bnRPRlZhbGlkYXRvcnNSZXF1aXJlZAIaAAAARHVwbGljYXRlV2l0aGRyYXdSZXF1ZXN0ZWQCFAAAAFdpdGhkcmF3QW1vdW50SXNaZXJvAhMAAABXaXRoZHJhd2FsSXNFeHBpcmVkAhUAAABJbnZhbGlkVmFsaWRhdG9ySW5kZXgCFwAAAER1cGxpY2F0ZVZhbGlkYXRvckluZGV4AiMAAABJbnZhbGlkTnVtYmVyT2ZTaWduYXR1cmVzQW5kSW5kZXhlcwIjAAAASW5jb3JyZWN0TnVtYmVyT2ZTaWduYXR1cmVzU3VwcGxpZWQCEAAAAEludmFsaWRTaWduYXR1cmUCEwAAAERlcG9zaXRBbW91bnRJc1plcm8CDQAAAHdpdGhkcmF3X2hhc2gGFAAGAAAAAgAAAGlkEyAAAAACCgAAAGV4cGlyYXRpb24FAgAAAHRvFQIAAAAHAAAAQWNjb3VudAEBAAAACwgAAABDb250cmFjdAEBAAAADAYAAABhbW91bnQFCgAAAHNpZ25hdHVyZXMQAhNAAAAAAgcAAABpbmRleGVzEAICFAABAAAABAAAAGhhc2gTIAAAAAIVFAAAAAwAAABVbmF1dGhvcml6ZWQCCwAAAFBhcnNlUGFyYW1zAgcAAABMb2dGdWxsAgwAAABMb2dNYWxmb3JtZWQCDgAAAENvbnRyYWN0UGF1c2VkAhMAAABJbnZva2VDb250cmFjdEVycm9yAhMAAABJbnZva2VUcmFuc2ZlckVycm9yAhoAAABGYWlsZWRVcGdyYWRlTWlzc2luZ01vZHVsZQIcAAAARmFpbGVkVXBncmFkZU1pc3NpbmdDb250cmFjdAIlAAAARmFpbGVkVXBncmFkZVVuc3VwcG9ydGVkTW9kdWxlVmVyc2lvbgIgAAAASW52YWxpZENvdW50T0ZWYWxpZGF0b3JzUmVxdWlyZWQCGgAAAER1cGxpY2F0ZVdpdGhkcmF3UmVxdWVzdGVkAhQAAABXaXRoZHJhd0Ftb3VudElzWmVybwITAAAAV2l0aGRyYXdhbElzRXhwaXJlZAIVAAAASW52YWxpZFZhbGlkYXRvckluZGV4AhcAAABEdXBsaWNhdGVWYWxpZGF0b3JJbmRleAIjAAAASW52YWxpZE51bWJlck9mU2lnbmF0dXJlc0FuZEluZGV4ZXMCIwAAAEluY29ycmVjdE51bWJlck9mU2lnbmF0dXJlc1N1cHBsaWVkAhAAAABJbnZhbGlkU2lnbmF0dXJlAhMAAABEZXBvc2l0QW1vdW50SXNaZXJvAgEfBgAAAAAIAAAATmV3QWRtaW4AAQAAAAkAAABuZXdfYWRtaW4VAgAAAAcAAABBY2NvdW50AQEAAAALCAAAAENvbnRyYWN0AQEAAAAMAQcAAABEZXBvc2l0AAMAAAAGAAAAc2VuZGVyFQIAAAAHAAAAQWNjb3VudAEBAAAACwgAAABDb250cmFjdAEBAAAADAsAAABkZXN0aW5hdGlvbh4gAAAABgAAAGFtb3VudAUCCAAAAFdpdGhkcmF3AAMAAAACAAAAaWQeIAAAAAkAAAByZWNpcGllbnQVAgAAAAcAAABBY2NvdW50AQEAAAALCAAAAENvbnRyYWN0AQEAAAAMBgAAAGFtb3VudAUEDAAAAEFkZFZhbGlkYXRvcgACAAAACQAAAHZhbGlkYXRvch4gAAAABwAAAHZlcnNpb24EBQ8AAABSZW1vdmVWYWxpZGF0b3IAAgAAAAkAAAB2YWxpZGF0b3IeIAAAAAcAAAB2ZXJzaW9uBAYVAAAAU2V0UmVxdWlyZWRWYWxpZGF0b3JzAAEAAAATAAAAdmFsaWRhdG9yc19yZXF1aXJlZAI'
        const param = serializeUpdateContractParameters(
            CONTRACT_NAME,
            method,
            parameters,
            toBuffer(BRIDGE_CONTRACT_RAW_SCHEMA, 'base64')
        );
        // eslint-disable-next-line no-console
        console.log(param);
        const res = await provider.sendTransaction(
            concordiumAccount,
            AccountTransactionType.Update,
            {
                amount: new CcdAmount(BigInt(ccdValue)),
                address: {
                    index: TOKEN_CONTRACT_INDEX,
                    subindex: CONTRACT_SUB_INDEX,
                },
                receiveName: `${CONTRACT_NAME}.${method}`,
                maxContractExecutionEnergy: 100000n,
            },
            parameters,
            {
                type: SchemaType.Parameter,
                value: param.toString(),
            },
            0
        );
        // eslint-disable-next-line no-console
        console.log(res)
    }
}

const withdrawEthereumTransaction = async (
  withdrawResult: WithdrawResult[],
  ethereumAccount: string
): Promise<void> => {
  await window.ethereum.request({ method: 'eth_requestAccounts' })
  const web3 = new Web3(window.ethereum)

  const withdrawERC20Request = {
    id: `0x${withdrawResult[0].deposit_id}`,
    expiration: BigNumber.from(withdrawResult[0].expiration),
    recipient: ethereumAccount,
    amount: withdrawResult[0].amount,
    token: withdrawResult[0].token,
  }

  const bridgeContract = new web3.eth.Contract(
    BridgeContractBuild.abi as Web3utils.AbiItem[],
    process.env.REACT_APP_ETHEREUM_BRIDGE_ACCOUNT
  )

  const indexes: number[] = []
  const signatures: Buffer[] = []

  for (let i = 0; i < validatorUrls.length; i++) {
    const addressSigner: string = await bridgeContract.methods.signers(i).call()
    const currentSignature =
      withdrawResult.find(result => result.address === addressSigner)
        ?.signature || ''
    indexes.push(i)
    signatures.push(Buffer.from(currentSignature, 'hex'))
  }

  return bridgeContract.methods
    .withdrawERC20(withdrawERC20Request, signatures, indexes)
    .send({ from: ethereumAccount })
}


const invokeMethod = async (
    method: string,
    parameters: unknown,
    schemaVersion: number = 0,
): Promise<boolean> => {
    const CONTRACT_NAME = ""
    const TOKEN_CONTRACT_INDEX = 0n
    const CONTRACT_SUB_INDEX = 0n
    const BRIDGE_CONTRACT_RAW_SCHEMA = '//8DAQAAAAoAAABnYm1fQnJpZGdlAQAUAAQAAAAFAAAAdG9rZW4MCAAAAHRva2VuX2lkHQAKAAAAdmFsaWRhdG9ycxACEyEAAAACEwAAAHZhbGlkYXRvcnNfcmVxdWlyZWQCDAAAAAwAAABhZGRWYWxpZGF0b3IEEyEAAAACFRQAAAAMAAAAVW5hdXRob3JpemVkAgsAAABQYXJzZVBhcmFtcwIHAAAATG9nRnVsbAIMAAAATG9nTWFsZm9ybWVkAg4AAABDb250cmFjdFBhdXNlZAITAAAASW52b2tlQ29udHJhY3RFcnJvcgITAAAASW52b2tlVHJhbnNmZXJFcnJvcgIaAAAARmFpbGVkVXBncmFkZU1pc3NpbmdNb2R1bGUCHAAAAEZhaWxlZFVwZ3JhZGVNaXNzaW5nQ29udHJhY3QCJQAAAEZhaWxlZFVwZ3JhZGVVbnN1cHBvcnRlZE1vZHVsZVZlcnNpb24CIAAAAEludmFsaWRDb3VudE9GVmFsaWRhdG9yc1JlcXVpcmVkAhoAAABEdXBsaWNhdGVXaXRoZHJhd1JlcXVlc3RlZAIUAAAAV2l0aGRyYXdBbW91bnRJc1plcm8CEwAAAFdpdGhkcmF3YWxJc0V4cGlyZWQCFQAAAEludmFsaWRWYWxpZGF0b3JJbmRleAIXAAAARHVwbGljYXRlVmFsaWRhdG9ySW5kZXgCIwAAAEludmFsaWROdW1iZXJPZlNpZ25hdHVyZXNBbmRJbmRleGVzAiMAAABJbmNvcnJlY3ROdW1iZXJPZlNpZ25hdHVyZXNTdXBwbGllZAIQAAAASW52YWxpZFNpZ25hdHVyZQITAAAARGVwb3NpdEFtb3VudElzWmVybwIHAAAAZGVwb3NpdAQUAAIAAAALAAAAZGVzdGluYXRpb24TAAEAAAIGAAAAYW1vdW50BRUUAAAADAAAAFVuYXV0aG9yaXplZAILAAAAUGFyc2VQYXJhbXMCBwAAAExvZ0Z1bGwCDAAAAExvZ01hbGZvcm1lZAIOAAAAQ29udHJhY3RQYXVzZWQCEwAAAEludm9rZUNvbnRyYWN0RXJyb3ICEwAAAEludm9rZVRyYW5zZmVyRXJyb3ICGgAAAEZhaWxlZFVwZ3JhZGVNaXNzaW5nTW9kdWxlAhwAAABGYWlsZWRVcGdyYWRlTWlzc2luZ0NvbnRyYWN0AiUAAABGYWlsZWRVcGdyYWRlVW5zdXBwb3J0ZWRNb2R1bGVWZXJzaW9uAiAAAABJbnZhbGlkQ291bnRPRlZhbGlkYXRvcnNSZXF1aXJlZAIaAAAARHVwbGljYXRlV2l0aGRyYXdSZXF1ZXN0ZWQCFAAAAFdpdGhkcmF3QW1vdW50SXNaZXJvAhMAAABXaXRoZHJhd2FsSXNFeHBpcmVkAhUAAABJbnZhbGlkVmFsaWRhdG9ySW5kZXgCFwAAAER1cGxpY2F0ZVZhbGlkYXRvckluZGV4AiMAAABJbnZhbGlkTnVtYmVyT2ZTaWduYXR1cmVzQW5kSW5kZXhlcwIjAAAASW5jb3JyZWN0TnVtYmVyT2ZTaWduYXR1cmVzU3VwcGxpZWQCEAAAAEludmFsaWRTaWduYXR1cmUCEwAAAERlcG9zaXRBbW91bnRJc1plcm8CDwAAAHJlbW92ZVZhbGlkYXRvcgQTIQAAAAIVFAAAAAwAAABVbmF1dGhvcml6ZWQCCwAAAFBhcnNlUGFyYW1zAgcAAABMb2dGdWxsAgwAAABMb2dNYWxmb3JtZWQCDgAAAENvbnRyYWN0UGF1c2VkAhMAAABJbnZva2VDb250cmFjdEVycm9yAhMAAABJbnZva2VUcmFuc2ZlckVycm9yAhoAAABGYWlsZWRVcGdyYWRlTWlzc2luZ01vZHVsZQIcAAAARmFpbGVkVXBncmFkZU1pc3NpbmdDb250cmFjdAIlAAAARmFpbGVkVXBncmFkZVVuc3VwcG9ydGVkTW9kdWxlVmVyc2lvbgIgAAAASW52YWxpZENvdW50T0ZWYWxpZGF0b3JzUmVxdWlyZWQCGgAAAER1cGxpY2F0ZVdpdGhkcmF3UmVxdWVzdGVkAhQAAABXaXRoZHJhd0Ftb3VudElzWmVybwITAAAAV2l0aGRyYXdhbElzRXhwaXJlZAIVAAAASW52YWxpZFZhbGlkYXRvckluZGV4AhcAAABEdXBsaWNhdGVWYWxpZGF0b3JJbmRleAIjAAAASW52YWxpZE51bWJlck9mU2lnbmF0dXJlc0FuZEluZGV4ZXMCIwAAAEluY29ycmVjdE51bWJlck9mU2lnbmF0dXJlc1N1cHBsaWVkAhAAAABJbnZhbGlkU2lnbmF0dXJlAhMAAABEZXBvc2l0QW1vdW50SXNaZXJvAg8AAABzZXRJbXBsZW1lbnRvcnMEFAACAAAAAgAAAGlkFgAMAAAAaW1wbGVtZW50b3JzEAIMFRQAAAAMAAAAVW5hdXRob3JpemVkAgsAAABQYXJzZVBhcmFtcwIHAAAATG9nRnVsbAIMAAAATG9nTWFsZm9ybWVkAg4AAABDb250cmFjdFBhdXNlZAITAAAASW52b2tlQ29udHJhY3RFcnJvcgITAAAASW52b2tlVHJhbnNmZXJFcnJvcgIaAAAARmFpbGVkVXBncmFkZU1pc3NpbmdNb2R1bGUCHAAAAEZhaWxlZFVwZ3JhZGVNaXNzaW5nQ29udHJhY3QCJQAAAEZhaWxlZFVwZ3JhZGVVbnN1cHBvcnRlZE1vZHVsZVZlcnNpb24CIAAAAEludmFsaWRDb3VudE9GVmFsaWRhdG9yc1JlcXVpcmVkAhoAAABEdXBsaWNhdGVXaXRoZHJhd1JlcXVlc3RlZAIUAAAAV2l0aGRyYXdBbW91bnRJc1plcm8CEwAAAFdpdGhkcmF3YWxJc0V4cGlyZWQCFQAAAEludmFsaWRWYWxpZGF0b3JJbmRleAIXAAAARHVwbGljYXRlVmFsaWRhdG9ySW5kZXgCIwAAAEludmFsaWROdW1iZXJPZlNpZ25hdHVyZXNBbmRJbmRleGVzAiMAAABJbmNvcnJlY3ROdW1iZXJPZlNpZ25hdHVyZXNTdXBwbGllZAIQAAAASW52YWxpZFNpZ25hdHVyZQITAAAARGVwb3NpdEFtb3VudElzWmVybwIJAAAAc2V0UGF1c2VkBBQAAQAAAAYAAABwYXVzZWQBFRQAAAAMAAAAVW5hdXRob3JpemVkAgsAAABQYXJzZVBhcmFtcwIHAAAATG9nRnVsbAIMAAAATG9nTWFsZm9ybWVkAg4AAABDb250cmFjdFBhdXNlZAITAAAASW52b2tlQ29udHJhY3RFcnJvcgITAAAASW52b2tlVHJhbnNmZXJFcnJvcgIaAAAARmFpbGVkVXBncmFkZU1pc3NpbmdNb2R1bGUCHAAAAEZhaWxlZFVwZ3JhZGVNaXNzaW5nQ29udHJhY3QCJQAAAEZhaWxlZFVwZ3JhZGVVbnN1cHBvcnRlZE1vZHVsZVZlcnNpb24CIAAAAEludmFsaWRDb3VudE9GVmFsaWRhdG9yc1JlcXVpcmVkAhoAAABEdXBsaWNhdGVXaXRoZHJhd1JlcXVlc3RlZAIUAAAAV2l0aGRyYXdBbW91bnRJc1plcm8CEwAAAFdpdGhkcmF3YWxJc0V4cGlyZWQCFQAAAEludmFsaWRWYWxpZGF0b3JJbmRleAIXAAAARHVwbGljYXRlVmFsaWRhdG9ySW5kZXgCIwAAAEludmFsaWROdW1iZXJPZlNpZ25hdHVyZXNBbmRJbmRleGVzAiMAAABJbmNvcnJlY3ROdW1iZXJPZlNpZ25hdHVyZXNTdXBwbGllZAIQAAAASW52YWxpZFNpZ25hdHVyZQITAAAARGVwb3NpdEFtb3VudElzWmVybwIVAAAAc2V0VmFsaWRhdG9yc1JlcXVpcmVkBAQVFAAAAAwAAABVbmF1dGhvcml6ZWQCCwAAAFBhcnNlUGFyYW1zAgcAAABMb2dGdWxsAgwAAABMb2dNYWxmb3JtZWQCDgAAAENvbnRyYWN0UGF1c2VkAhMAAABJbnZva2VDb250cmFjdEVycm9yAhMAAABJbnZva2VUcmFuc2ZlckVycm9yAhoAAABGYWlsZWRVcGdyYWRlTWlzc2luZ01vZHVsZQIcAAAARmFpbGVkVXBncmFkZU1pc3NpbmdDb250cmFjdAIlAAAARmFpbGVkVXBncmFkZVVuc3VwcG9ydGVkTW9kdWxlVmVyc2lvbgIgAAAASW52YWxpZENvdW50T0ZWYWxpZGF0b3JzUmVxdWlyZWQCGgAAAER1cGxpY2F0ZVdpdGhkcmF3UmVxdWVzdGVkAhQAAABXaXRoZHJhd0Ftb3VudElzWmVybwITAAAAV2l0aGRyYXdhbElzRXhwaXJlZAIVAAAASW52YWxpZFZhbGlkYXRvckluZGV4AhcAAABEdXBsaWNhdGVWYWxpZGF0b3JJbmRleAIjAAAASW52YWxpZE51bWJlck9mU2lnbmF0dXJlc0FuZEluZGV4ZXMCIwAAAEluY29ycmVjdE51bWJlck9mU2lnbmF0dXJlc1N1cHBsaWVkAhAAAABJbnZhbGlkU2lnbmF0dXJlAhMAAABEZXBvc2l0QW1vdW50SXNaZXJvAggAAABzdXBwb3J0cwYQARYAEAEVAwAAAAkAAABOb1N1cHBvcnQCBwAAAFN1cHBvcnQCCQAAAFN1cHBvcnRCeQEBAAAAEAAMFRQAAAAMAAAAVW5hdXRob3JpemVkAgsAAABQYXJzZVBhcmFtcwIHAAAATG9nRnVsbAIMAAAATG9nTWFsZm9ybWVkAg4AAABDb250cmFjdFBhdXNlZAITAAAASW52b2tlQ29udHJhY3RFcnJvcgITAAAASW52b2tlVHJhbnNmZXJFcnJvcgIaAAAARmFpbGVkVXBncmFkZU1pc3NpbmdNb2R1bGUCHAAAAEZhaWxlZFVwZ3JhZGVNaXNzaW5nQ29udHJhY3QCJQAAAEZhaWxlZFVwZ3JhZGVVbnN1cHBvcnRlZE1vZHVsZVZlcnNpb24CIAAAAEludmFsaWRDb3VudE9GVmFsaWRhdG9yc1JlcXVpcmVkAhoAAABEdXBsaWNhdGVXaXRoZHJhd1JlcXVlc3RlZAIUAAAAV2l0aGRyYXdBbW91bnRJc1plcm8CEwAAAFdpdGhkcmF3YWxJc0V4cGlyZWQCFQAAAEludmFsaWRWYWxpZGF0b3JJbmRleAIXAAAARHVwbGljYXRlVmFsaWRhdG9ySW5kZXgCIwAAAEludmFsaWROdW1iZXJPZlNpZ25hdHVyZXNBbmRJbmRleGVzAiMAAABJbmNvcnJlY3ROdW1iZXJPZlNpZ25hdHVyZXNTdXBwbGllZAIQAAAASW52YWxpZFNpZ25hdHVyZQITAAAARGVwb3NpdEFtb3VudElzWmVybwILAAAAdXBkYXRlQWRtaW4EFQIAAAAHAAAAQWNjb3VudAEBAAAACwgAAABDb250cmFjdAEBAAAADBUUAAAADAAAAFVuYXV0aG9yaXplZAILAAAAUGFyc2VQYXJhbXMCBwAAAExvZ0Z1bGwCDAAAAExvZ01hbGZvcm1lZAIOAAAAQ29udHJhY3RQYXVzZWQCEwAAAEludm9rZUNvbnRyYWN0RXJyb3ICEwAAAEludm9rZVRyYW5zZmVyRXJyb3ICGgAAAEZhaWxlZFVwZ3JhZGVNaXNzaW5nTW9kdWxlAhwAAABGYWlsZWRVcGdyYWRlTWlzc2luZ0NvbnRyYWN0AiUAAABGYWlsZWRVcGdyYWRlVW5zdXBwb3J0ZWRNb2R1bGVWZXJzaW9uAiAAAABJbnZhbGlkQ291bnRPRlZhbGlkYXRvcnNSZXF1aXJlZAIaAAAARHVwbGljYXRlV2l0aGRyYXdSZXF1ZXN0ZWQCFAAAAFdpdGhkcmF3QW1vdW50SXNaZXJvAhMAAABXaXRoZHJhd2FsSXNFeHBpcmVkAhUAAABJbnZhbGlkVmFsaWRhdG9ySW5kZXgCFwAAAER1cGxpY2F0ZVZhbGlkYXRvckluZGV4AiMAAABJbnZhbGlkTnVtYmVyT2ZTaWduYXR1cmVzQW5kSW5kZXhlcwIjAAAASW5jb3JyZWN0TnVtYmVyT2ZTaWduYXR1cmVzU3VwcGxpZWQCEAAAAEludmFsaWRTaWduYXR1cmUCEwAAAERlcG9zaXRBbW91bnRJc1plcm8CBwAAAHVwZ3JhZGUEFAACAAAABgAAAG1vZHVsZR4gAAAABwAAAG1pZ3JhdGUVAgAAAAQAAABOb25lAgQAAABTb21lAQEAAAAPFgEdARUUAAAADAAAAFVuYXV0aG9yaXplZAILAAAAUGFyc2VQYXJhbXMCBwAAAExvZ0Z1bGwCDAAAAExvZ01hbGZvcm1lZAIOAAAAQ29udHJhY3RQYXVzZWQCEwAAAEludm9rZUNvbnRyYWN0RXJyb3ICEwAAAEludm9rZVRyYW5zZmVyRXJyb3ICGgAAAEZhaWxlZFVwZ3JhZGVNaXNzaW5nTW9kdWxlAhwAAABGYWlsZWRVcGdyYWRlTWlzc2luZ0NvbnRyYWN0AiUAAABGYWlsZWRVcGdyYWRlVW5zdXBwb3J0ZWRNb2R1bGVWZXJzaW9uAiAAAABJbnZhbGlkQ291bnRPRlZhbGlkYXRvcnNSZXF1aXJlZAIaAAAARHVwbGljYXRlV2l0aGRyYXdSZXF1ZXN0ZWQCFAAAAFdpdGhkcmF3QW1vdW50SXNaZXJvAhMAAABXaXRoZHJhd2FsSXNFeHBpcmVkAhUAAABJbnZhbGlkVmFsaWRhdG9ySW5kZXgCFwAAAER1cGxpY2F0ZVZhbGlkYXRvckluZGV4AiMAAABJbnZhbGlkTnVtYmVyT2ZTaWduYXR1cmVzQW5kSW5kZXhlcwIjAAAASW5jb3JyZWN0TnVtYmVyT2ZTaWduYXR1cmVzU3VwcGxpZWQCEAAAAEludmFsaWRTaWduYXR1cmUCEwAAAERlcG9zaXRBbW91bnRJc1plcm8CBAAAAHZpZXcFFAAHAAAABQAAAGFkbWluFQIAAAAHAAAAQWNjb3VudAEBAAAACwgAAABDb250cmFjdAEBAAAADAUAAAB0b2tlbgwIAAAAdG9rZW5faWQdAAYAAABwYXVzZWQBCgAAAHZhbGlkYXRvcnMQAhMhAAAAAhMAAAB2YWxpZGF0b3JzX3JlcXVpcmVkAgcAAAB2ZXJzaW9uBBUUAAAADAAAAFVuYXV0aG9yaXplZAILAAAAUGFyc2VQYXJhbXMCBwAAAExvZ0Z1bGwCDAAAAExvZ01hbGZvcm1lZAIOAAAAQ29udHJhY3RQYXVzZWQCEwAAAEludm9rZUNvbnRyYWN0RXJyb3ICEwAAAEludm9rZVRyYW5zZmVyRXJyb3ICGgAAAEZhaWxlZFVwZ3JhZGVNaXNzaW5nTW9kdWxlAhwAAABGYWlsZWRVcGdyYWRlTWlzc2luZ0NvbnRyYWN0AiUAAABGYWlsZWRVcGdyYWRlVW5zdXBwb3J0ZWRNb2R1bGVWZXJzaW9uAiAAAABJbnZhbGlkQ291bnRPRlZhbGlkYXRvcnNSZXF1aXJlZAIaAAAARHVwbGljYXRlV2l0aGRyYXdSZXF1ZXN0ZWQCFAAAAFdpdGhkcmF3QW1vdW50SXNaZXJvAhMAAABXaXRoZHJhd2FsSXNFeHBpcmVkAhUAAABJbnZhbGlkVmFsaWRhdG9ySW5kZXgCFwAAAER1cGxpY2F0ZVZhbGlkYXRvckluZGV4AiMAAABJbnZhbGlkTnVtYmVyT2ZTaWduYXR1cmVzQW5kSW5kZXhlcwIjAAAASW5jb3JyZWN0TnVtYmVyT2ZTaWduYXR1cmVzU3VwcGxpZWQCEAAAAEludmFsaWRTaWduYXR1cmUCEwAAAERlcG9zaXRBbW91bnRJc1plcm8CCAAAAHdpdGhkcmF3BBQABgAAAAIAAABpZBMgAAAAAgoAAABleHBpcmF0aW9uBQIAAAB0bxUCAAAABwAAAEFjY291bnQBAQAAAAsIAAAAQ29udHJhY3QBAQAAAAwGAAAAYW1vdW50BQoAAABzaWduYXR1cmVzEAITQAAAAAIHAAAAaW5kZXhlcxACAhUUAAAADAAAAFVuYXV0aG9yaXplZAILAAAAUGFyc2VQYXJhbXMCBwAAAExvZ0Z1bGwCDAAAAExvZ01hbGZvcm1lZAIOAAAAQ29udHJhY3RQYXVzZWQCEwAAAEludm9rZUNvbnRyYWN0RXJyb3ICEwAAAEludm9rZVRyYW5zZmVyRXJyb3ICGgAAAEZhaWxlZFVwZ3JhZGVNaXNzaW5nTW9kdWxlAhwAAABGYWlsZWRVcGdyYWRlTWlzc2luZ0NvbnRyYWN0AiUAAABGYWlsZWRVcGdyYWRlVW5zdXBwb3J0ZWRNb2R1bGVWZXJzaW9uAiAAAABJbnZhbGlkQ291bnRPRlZhbGlkYXRvcnNSZXF1aXJlZAIaAAAARHVwbGljYXRlV2l0aGRyYXdSZXF1ZXN0ZWQCFAAAAFdpdGhkcmF3QW1vdW50SXNaZXJvAhMAAABXaXRoZHJhd2FsSXNFeHBpcmVkAhUAAABJbnZhbGlkVmFsaWRhdG9ySW5kZXgCFwAAAER1cGxpY2F0ZVZhbGlkYXRvckluZGV4AiMAAABJbnZhbGlkTnVtYmVyT2ZTaWduYXR1cmVzQW5kSW5kZXhlcwIjAAAASW5jb3JyZWN0TnVtYmVyT2ZTaWduYXR1cmVzU3VwcGxpZWQCEAAAAEludmFsaWRTaWduYXR1cmUCEwAAAERlcG9zaXRBbW91bnRJc1plcm8CDQAAAHdpdGhkcmF3X2hhc2gGFAAGAAAAAgAAAGlkEyAAAAACCgAAAGV4cGlyYXRpb24FAgAAAHRvFQIAAAAHAAAAQWNjb3VudAEBAAAACwgAAABDb250cmFjdAEBAAAADAYAAABhbW91bnQFCgAAAHNpZ25hdHVyZXMQAhNAAAAAAgcAAABpbmRleGVzEAICFAABAAAABAAAAGhhc2gTIAAAAAIVFAAAAAwAAABVbmF1dGhvcml6ZWQCCwAAAFBhcnNlUGFyYW1zAgcAAABMb2dGdWxsAgwAAABMb2dNYWxmb3JtZWQCDgAAAENvbnRyYWN0UGF1c2VkAhMAAABJbnZva2VDb250cmFjdEVycm9yAhMAAABJbnZva2VUcmFuc2ZlckVycm9yAhoAAABGYWlsZWRVcGdyYWRlTWlzc2luZ01vZHVsZQIcAAAARmFpbGVkVXBncmFkZU1pc3NpbmdDb250cmFjdAIlAAAARmFpbGVkVXBncmFkZVVuc3VwcG9ydGVkTW9kdWxlVmVyc2lvbgIgAAAASW52YWxpZENvdW50T0ZWYWxpZGF0b3JzUmVxdWlyZWQCGgAAAER1cGxpY2F0ZVdpdGhkcmF3UmVxdWVzdGVkAhQAAABXaXRoZHJhd0Ftb3VudElzWmVybwITAAAAV2l0aGRyYXdhbElzRXhwaXJlZAIVAAAASW52YWxpZFZhbGlkYXRvckluZGV4AhcAAABEdXBsaWNhdGVWYWxpZGF0b3JJbmRleAIjAAAASW52YWxpZE51bWJlck9mU2lnbmF0dXJlc0FuZEluZGV4ZXMCIwAAAEluY29ycmVjdE51bWJlck9mU2lnbmF0dXJlc1N1cHBsaWVkAhAAAABJbnZhbGlkU2lnbmF0dXJlAhMAAABEZXBvc2l0QW1vdW50SXNaZXJvAgEfBgAAAAAIAAAATmV3QWRtaW4AAQAAAAkAAABuZXdfYWRtaW4VAgAAAAcAAABBY2NvdW50AQEAAAALCAAAAENvbnRyYWN0AQEAAAAMAQcAAABEZXBvc2l0AAMAAAAGAAAAc2VuZGVyFQIAAAAHAAAAQWNjb3VudAEBAAAACwgAAABDb250cmFjdAEBAAAADAsAAABkZXN0aW5hdGlvbh4gAAAABgAAAGFtb3VudAUCCAAAAFdpdGhkcmF3AAMAAAACAAAAaWQeIAAAAAkAAAByZWNpcGllbnQVAgAAAAcAAABBY2NvdW50AQEAAAALCAAAAENvbnRyYWN0AQEAAAAMBgAAAGFtb3VudAUEDAAAAEFkZFZhbGlkYXRvcgACAAAACQAAAHZhbGlkYXRvch4gAAAABwAAAHZlcnNpb24EBQ8AAABSZW1vdmVWYWxpZGF0b3IAAgAAAAkAAAB2YWxpZGF0b3IeIAAAAAcAAAB2ZXJzaW9uBAYVAAAAU2V0UmVxdWlyZWRWYWxpZGF0b3JzAAEAAAATAAAAdmFsaWRhdG9yc19yZXF1aXJlZAI'
    const param = serializeUpdateContractParameters(
        CONTRACT_NAME,
        method,
        parameters,
        toBuffer(BRIDGE_CONTRACT_RAW_SCHEMA, 'base64')
    );
    // eslint-disable-next-line no-console
    console.log(param);
    const gRPCProvider = new HttpProvider("http://localhost:9095")
    const rpcClient = new JsonRpcClient(gRPCProvider)
    const res = await rpcClient.invokeContract({
        method: `${CONTRACT_NAME}.${method}`,
        contract: {
            index: TOKEN_CONTRACT_INDEX,
            subindex: CONTRACT_SUB_INDEX
        },
        parameter: param,
    });
    if (!res || res.tag === 'failure' || !res.returnValue) {
        throw new Error(
            `RPC call 'invokeContract' on method '${CONTRACT_NAME}.${method}' of contract '${TOKEN_CONTRACT_INDEX}' failed`
        );
    }
    const returnValues = deserializeReceiveReturnValue(
        toBuffer(res.returnValue, 'hex'),
        toBuffer(BRIDGE_CONTRACT_RAW_SCHEMA, 'base64'),
        CONTRACT_NAME,
        method,
        schemaVersion
    );
    // eslint-disable-next-line no-console
    console.log(returnValues);
    // eslint-disable-next-line no-console
    console.log(returnValues.admin.Account[0]);
    return true
}

export {
    connectConcordiumWallet,
    depositConcordiumTransaction,
    withdrawEthereumTransaction,
}
